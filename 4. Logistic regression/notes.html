<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Logistic Regression, Prediction and ROC </title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Logistic Regression, Prediction and ROC </h1>

<p>The objective of this case is to get you understand logistic regression (binary classification) and some important ideas such as cross validation, ROC curve, cut-off probability.
Code in this case is built upon lecture slides and Shaonan Tian&#39;s sample code.</p>

<h2>Input and sample data</h2>

<p>First load the credit scoring data. It is easy to load comma-separated values (CSV). </p>

<pre><code class="r">credit.data &lt;- read.csv(&quot;http://homepages.uc.edu/~maifg/7040/credit0.csv&quot;, header = T)
</code></pre>

<p>Now split the data 90/10 as training/testing datasets:</p>

<pre><code class="r">sample_index &lt;- sample(nrow(credit.data), nrow(credit.data) * 0.9)
credit.train = credit.data[sample_index, ]
credit.test = credit.data[-sample_index, ]
</code></pre>

<p>The training dataset has 63 variables, 4500 obs. </p>

<pre><code class="r">colnames(credit.train)
</code></pre>

<pre><code>##  [1] &quot;id&quot;     &quot;Y&quot;      &quot;X2&quot;     &quot;X3&quot;     &quot;X4&quot;     &quot;X5&quot;     &quot;X6&quot;    
##  [8] &quot;X7&quot;     &quot;X8&quot;     &quot;X9&quot;     &quot;X10_2&quot;  &quot;X11_2&quot;  &quot;X12_2&quot;  &quot;X13_2&quot; 
## [15] &quot;X14_2&quot;  &quot;X15_2&quot;  &quot;X15_3&quot;  &quot;X15_4&quot;  &quot;X15_5&quot;  &quot;X15_6&quot;  &quot;X16_2&quot; 
## [22] &quot;X16_3&quot;  &quot;X16_4&quot;  &quot;X16_5&quot;  &quot;X16_6&quot;  &quot;X17_2&quot;  &quot;X17_3&quot;  &quot;X17_4&quot; 
## [29] &quot;X17_5&quot;  &quot;X17_6&quot;  &quot;X18_2&quot;  &quot;X18_3&quot;  &quot;X18_4&quot;  &quot;X18_5&quot;  &quot;X18_6&quot; 
## [36] &quot;X18_7&quot;  &quot;X19_2&quot;  &quot;X19_3&quot;  &quot;X19_4&quot;  &quot;X19_5&quot;  &quot;X19_6&quot;  &quot;X19_7&quot; 
## [43] &quot;X19_8&quot;  &quot;X19_9&quot;  &quot;X19_10&quot; &quot;X20_2&quot;  &quot;X20_3&quot;  &quot;X20_4&quot;  &quot;X21_2&quot; 
## [50] &quot;X21_3&quot;  &quot;X22_2&quot;  &quot;X22_3&quot;  &quot;X22_4&quot;  &quot;X22_5&quot;  &quot;X22_6&quot;  &quot;X22_7&quot; 
## [57] &quot;X22_8&quot;  &quot;X22_9&quot;  &quot;X22_10&quot; &quot;X22_11&quot; &quot;X23_2&quot;  &quot;X23_3&quot;  &quot;X24_2&quot;
</code></pre>

<h2>Logistic Regression</h2>

<p>Let&#39;s build a logistic regression model based on all X variables. Note id is excluded from the model.</p>

<pre><code class="r">credit.glm0 &lt;- glm(Y ~ . - id, family = binomial, credit.train)
</code></pre>

<p>You can view the result of the estimation:</p>

<pre><code class="r">summary(credit.glm0)
</code></pre>

<p>Note that there might be a warning message &ldquo;<em>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</em>&rdquo;. This happens because of a problem called quasi-complete separation. You can <a href="http://www.ats.ucla.edu/stat/mult_pkg/faq/general/complete_separation_logit_models.htm">learn more here</a> or <a href="http://support.sas.com/kb/22/599.html">here</a>. The offending variable is <em>X9</em>. We will choose to ignore the warning now. You can try fitting your model without <em>X9</em>.</p>

<p>The usual stepwise variable selection still works for logistic regression. <strong>caution: this will take a very long time</strong>.</p>

<pre><code class="r">credit.glm.step &lt;- step(credit.glm0)
</code></pre>

<p>Or you can try model selection with BIC:</p>

<pre><code class="r">credit.glm.step &lt;- step(credit.glm0, k = log(nrow(credit.train)))
</code></pre>

<h2>Prediction and Cross Validation Using Logistic Regression</h2>

<p>Now suppose there are 2 models we want to test, one with all X variables(credit.glm0), and one with X3, X8 and X11_2(credit.glm1).</p>

<pre><code class="r">credit.glm1 &lt;- glm(Y ~ X3 + X8 + X11_2, family = binomial, credit.train)
AIC(credit.glm0)
</code></pre>

<pre><code>## [1] 1701
</code></pre>

<pre><code class="r">AIC(credit.glm1)
</code></pre>

<pre><code>## [1] 1858
</code></pre>

<pre><code class="r">BIC(credit.glm0)
</code></pre>

<pre><code>## [1] 2099
</code></pre>

<pre><code class="r">BIC(credit.glm1)
</code></pre>

<pre><code>## [1] 1884
</code></pre>

<h3>Understanding classification decision making using logistic regression</h3>

<p>To get prediction from a logistic regression model, there are several steps you need to understand. Refer to textbook/slides for detailed math.</p>

<p>1.The fitted model \( \hat{\eta} = b_0 +b_1 x_1 + b_2 x_2 + ... \) gives you the estimated value before the inverse of link (logit in case of logistic regression). In logistic regression the \( \hat{\eta} \) are called <strong>log odds ratio</strong>, which is \( \log(P(y=1)/(1-P(y=1))) \). In R you use the <em>predict()</em> function to get a vector of all in-sample \( \hat{\eta} \) (for each training ob).</p>

<pre><code class="r">hist(predict(credit.glm1))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85j485j9plAABlADllAGVlOQBlOTllOY9lZjlltbVltf2POQCPOTmPZgCPjzmPj2WPtY+P27WP29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v1PiNEKAAAAM3RSTlP//////////////////////////////////////////////////////////////////wBxnr2OAAAACXBIWXMAAAsSAAALEgHS3X78AAAJSUlEQVR4nO2di5abNhRFI086sZumtSdpU3v6NElqmgY//v/jqisJbA+CI54Gc/ZayQgsQGxfSWAEvDqRUl7dugBDh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQoIKgw+phdzodNw87m0qJ1g22v1+o2RZv+fGbZ5tx+ZLnpV6W8Hpdrhxz+W+ZW0stQVezI9VEUNDSsqv5pQ6redhSuW3kBUVKycqinLgGEaS/e/WwO26UWXes/4h+Pf3wRZfsuJl91LGR6Nn6e07UGz1/pzOlRbX5zdJmN/RqP8n6Tm5Bk2FtV6h+TWNBJrJtxvK5nVO21D+uhBeFk3VdFknP/8FkSVQuhGoLOqyU7Nx/dvORTOi/puyvFyJIPv1qM31LVIr7ilz+S0HKZnWzbIbleb5s0064XdZOtu5j94l/qbOgrHBW0LlIx2f9Tc5PnlCtKChdoWxgv7gI4P1CF/awmm33C20gtvs5P3tNlCyg1pJF5mX5s/DX+ZeyhbVd0KxdvotshXabekKWkH9mZ9I5ZUtl27ia+6JIVlCu/WggyEyZFlBv3q5ex7xJHGwV26YLSWnmJxsCdm6W/0KQrCtWS5vFfb+zbbZCu1OuBtgvRdtI55QtlW3jxbquipQKyrX7zdog5WKgSJDJkwk6a6staJ4TlLYu9QRlRXIriloUlBa0qIrJpvQOm8B+Kai0ilmzrgLnq5isMxOUzilbqqiKeQS1GUFpcNge0tNIn7/SvKAs/6WgtJE2WaLLNvtFI223adqgcyNdvJTL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" alt="plot of chunk unnamed-chunk-9"/> </p>

<p>2.For each \( \hat{\eta} \), in order to get the P(y=1), we can apply the inverse of the link function (logit here) to \( \hat{\eta} \). The equation is \( P(y=1) =  1/ (1+exp(-\hat{\eta})) \). In R you use the <em>fitted()</em> function or <em>predict(,type=&ldquo;response&rdquo;) to get the **predicted probability</em>* for each training ob.</p>

<pre><code class="r">hist(predict(credit.glm1, type = &quot;response&quot;))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPjzmPj2WPj7WPtY+P27WP2/21ZgC1Zjm1ZmW1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v2BCA89AAAAOHRSTlP/////////////////////////////////////////////////////////////////////////ADtcEcoAAAAJcEhZcwAACxIAAAsSAdLdfvwAAArvSURBVHic7Z0Lm+K2FYbXQzrLdNttYTZN08L2kgSnSQrdMeD//8+qI8m2bF0+bBgGVt/3PDMg+ejo+EUXg3x5V1NJvXvrAG5dBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBA71ZnFN4/FQ8bZHRYPr4clrNtl1NKnbt0ya5UuRpucX3ZOOZuclgiJVX0uE6FchagsjihtOyqX+qwnEfsB6W8OnxAZVHMe8mLAhLfu6IoFipxXBez31Rkqsj3qm1UKluVrYr3Kn+rjJqKjb2yLgq9G8f17JdCmdS2oDZYGYfF35u2IInZVpeaK4tVbXNSpf5rrGsnOPHlhqTy/+AA0v7fr5Xbqli0gdWtc/u2SUnjKyWqfgiqb5jIZgKo1PZz4/ubJwEku/5lWWgCVdHIfnTW3gVUGFObZQwWXb7slEnYXdafms3ZJkp1gNrgDKAupONn9UkOAM2Ff/mwaV3VjfMhoMNyUe+8wA/Ldn9UF9s/qWAPy4fN/kkR2Jl8W6OJZrZVRFdiYqBb+7YxK3vtdGUK7tVuCPxt61Dc6ISUkD/dg5qcVKm2jl7uIKTK62K652j0JrDWeaQjeSGYDm4AGfeKuX5zMF1sY/DIRyTZpgmY3NbeASQ176RJi4n9fB82rUOzUwt3B1QETU6qVFvHwFcvJB/Qca06wLwLrHU+bEEtoF4IugXZLhYHJP2wA9Rhmwxo7gGah6I7GVAbkg9ITZI/Pi0mAzL7Ll10FuliYq78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" alt="plot of chunk unnamed-chunk-10"/> </p>

<p>3.Last but not least, you want a binary classification decision rule. The default rule is if the fitted \( P(y=1) > 0.5 \) then \( y = 1 \). The value 0.5 is called <strong>cut-off probability</strong>. You can choose the cut-off probability based on mis-classification rate, cost function, etc. In this case, the cost function can indicate the trade off between the risk of giving loan to someone who cannot pay (predict 0, truth 1), and risk of rejecting someone who qualifys (predict 1, truth 0).</p>

<p>These tables illustrate the impact of choosing different cut-off probability. Choosing a large cut-off probability will result in few cases being predicted as 1, and chossing a small cut-off probability will result in many cases being predicted as 1.</p>

<pre><code class="r">table(predict(credit.glm1, type = &quot;response&quot;) &gt; 0.5)
</code></pre>

<pre><code>## 
## FALSE 
##  4500
</code></pre>

<pre><code class="r">table(predict(credit.glm1, type = &quot;response&quot;) &gt; 0.2)
</code></pre>

<pre><code>## 
## FALSE  TRUE 
##  4334   166
</code></pre>

<pre><code class="r">table(predict(credit.glm1, type = &quot;response&quot;) &gt; 1e-04)
</code></pre>

<pre><code>## 
## FALSE  TRUE 
##     3  4497
</code></pre>

<h3>In-sample and out-of-sample prediction</h3>

<h4>In-sample (performance on training set)</h4>

<p>Suppose the cut-off probability is choosen as 0.2. The 2nd statement generates a logical vector (TRUE or FALSE) of whether each ob in training set has a fitted probability greater than 0.2. The 3rd statement transforms the logical vector to numeric (0 or 1). </p>

<pre><code class="r">prob.glm1.insample &lt;- predict(credit.glm1, type = &quot;response&quot;)
predicted.glm1.insample &lt;- prob.glm1.insample &gt; 0.2
predicted.glm1.insample &lt;- as.numeric(predicted.glm1.insample)
</code></pre>

<p>Next we look at the confusion matrix, <em>dnn</em> is used to label the column and row:</p>

<pre><code class="r">table(credit.train$Y, predicted.glm1.insample, dnn = c(&quot;Truth&quot;, &quot;Predicted&quot;))
</code></pre>

<pre><code>##      Predicted
## Truth    0    1
##     0 4108  126
##     1  226   40
</code></pre>

<p>There are many ways to calculate the error rate. The following is one way. The <em>ifelse</em> function returns a vector, the elements are 1 if actual != predicted, 0 otherwise. <em>mean</em> gives you the percentage of 1s in the vector.</p>

<pre><code class="r">mean(ifelse(credit.train$Y != predicted.glm1.insample, 1, 0))
</code></pre>

<pre><code>## [1] 0.07822
</code></pre>

<h4>Out-of-sample (performance on testing set)</h4>

<p>To do out-of-sample prediction you need to add the testing set as a second argument after the glm object. Remember to add type = &ldquo;response&rdquo;, otherwise you will get the log odds and not the probability.</p>

<pre><code class="r">prob.glm1.outsample &lt;- predict(credit.glm1, credit.test, type = &quot;response&quot;)
predicted.glm1.outsample &lt;- prob.glm1.outsample &gt; 0.2
predicted.glm1.outsample &lt;- as.numeric(predicted.glm1.outsample)
table(credit.test$Y, predicted.glm1.outsample, dnn = c(&quot;Truth&quot;, &quot;Predicted&quot;))
</code></pre>

<pre><code>##      Predicted
## Truth   0   1
##     0 450  16
##     1  30   4
</code></pre>

<pre><code class="r">mean(ifelse(credit.test$Y != predicted.glm1.outsample, 1, 0))
</code></pre>

<pre><code>## [1] 0.092
</code></pre>

<p>It is the same as:</p>

<pre><code class="r">glm1.outsample.logodds &lt;- predict(credit.glm1, credit.test)
predicted.glm1.outsample &lt;- exp(glm1.outsample.logodds)/(1 + exp(glm1.outsample.logodds)) &gt; 
    0.2
predicted.glm1.outsample &lt;- as.numeric(predicted.glm1.outsample)
table(credit.test$Y, predicted.glm1.outsample, dnn = c(&quot;Truth&quot;, &quot;Predicted&quot;))
mean(ifelse(credit.test$Y != predicted.glm1.outsample, 1, 0))
</code></pre>

<p>It is usually the case that your out-of-sample prediction error rate is higher than in-sample error rate.</p>

<h3>ROC Curve</h3>

<p>To get the ROC curve you need to install the verification library.</p>

<pre><code class="r">install.packages(&quot;verification&quot;)
</code></pre>

<p>To plot the ROC curve, the first argument of roc.plot is the vector with actual values &ldquo;A binary observation (coded {0, 1 } )&rdquo;. The second argument is the vector with predicted probability. </p>

<pre><code class="r">library(&quot;verification&quot;)
</code></pre>

<pre><code class="r">roc.plot(credit.test$Y == &quot;1&quot;, prob.glm1.outsample)
</code></pre>

<p>To get the area under the ROC curve:</p>

<pre><code class="r">roc.plot(credit.test$Y == &quot;1&quot;, prob.glm1.outsample)$roc.vol
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEX9/v0AAAAAADkAAGUAK2sAOTkAOWUAOY8AZrUrAAArAEw5AAA5ADk5AGU5OQA5OWU5OY85j9pMACtMAExMh75lAABlADllAGVlOQBlOY9lZjllZmVltbVltf1rh2tro76POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2jayujvr61ZgC1/rW1/tq1/v2+o2u+voe+vr7ajznatWXa24/a/rXa/v39tWX924/929r9/rX9/tr9/v24rIpkAAAAPXRSTlP///////////////////////////////////////////////////////////////////////////////8ACS+sXwAAAAlwSFlzAAALEgAACxIB0t1+/AAADThJREFUeJztnQ2f4zYRh9d7hQtsS5vCXq9AYBdKCQS2baCXsPH3/1zoxW+yRxq9S/bO/3fXiyeSHD/VyPJobN+1JKPuSv+A2kWAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECFFhQK+PDde7l/7z+0+Dea8U2mvbSKs6AHEu1wfx6f7Ythdp3Mky6lZuFQfEOw//7+1JIDgxVuwj6y9nwaptx63bEyv8+sgL3P++uf9NV2HHv22aQ5pfWA2g64PwLnbsR/nx9iQPedyaAOKd7j+8370+Mown0cXSOGFxQL3/XDofOjWHi3Ks49YU0E6yZN++/yQQii8TqA5Ah9YRkPC+M/uGFe8HKemRsVUc0LsXBmnfe5KtiwkY7OPP3EW3Doifv/jRD4O0JNYP0uMWK3JgHwZA7en+uwnbNKoBEDtoiQk7zZ+6KUEPiFURH3p7il9YBaB+0MUmivzDH0cX687xrSSUqBfRpQYiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIhRQtxqTZl13BcIA9eubl8WqStPpp2apVdvcAL1+86L8OwHU/fsTUGvFNldAhh6E1FylGB5HQEqSnNpWvJ9VjZp2cVz+Z7ENupg4JALU2RaDdHdEnoAmg3TfINvLiv8C5zH5XfQetFLNz1bN4oPUm3WxGaBmKEeAWgBQ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" alt="plot of chunk unnamed-chunk-20"/> </p>

<pre><code>##      Model   Area   p.value binorm.area
## 1 Model  1 0.6956 6.942e-05          NA
</code></pre>

<p>We can also compare the glm0 and glm1 on the same graph:</p>

<pre><code class="r">prob.glm0.outsample &lt;- predict(credit.glm0, credit.test, type = &quot;response&quot;)
roc.plot(x = credit.test$Y == &quot;1&quot;, pred = cbind(prob.glm0.outsample, prob.glm1.outsample), 
    legend = TRUE, leg.text = c(&quot;Full Model&quot;, &quot;X_3, X_8, and X_11_2&quot;))$roc.vol
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAB41BMVEX9/v0AAAAAAAMAAA4AADkAADoAAEwAAGUAAGYAAwAAAy4ABDoADncAJrUAOTkAOWUAOXsAOY8AOjoAOpAAZpAAZrUAZrYDAAADAAMDAAgDAw4DAy0DLv0DNdoEAAAEKFwLXP0OAAAOd/0Qhf0RAAYTc/0VAAAXACgXAGUdgf0gIAAgMXsrAEwu/v05AAA5ADk5AGU5OQA5OWU5OXs5OY85Zlc5e3s5j9o6AAA6Ojo6OmY6ZrY6kLY6kNtIOQBJvI9L2/1Oo75lAABlADllAGVlMQBlOQBlOY9lZjllZmVltbVltf1mAABmAGZmOpBmZmZmZrZmkJBmkNtmtv93DgB3/v17IAB7OQCHvr6PKgCPMSCPOQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2QOgCQOmaQZjqQkJCQkNuQtpCQtv+Q2/+h/v21ZgC1/rW1/tq1/v22ZgC2Zjq2Zma2kJC227a2/7a2//+7UQa7/v2+IgO+o2u+viK+vr7aZhHajx3ajznatWXa24/a/rXa/v3bkDrbkGbb25Db29vb///9dw79gSj9oS39tWX9vDr922b924/929r9/i79/m/9/nf9/pz9/rX9/tr9/v3/AAD/tmb/tpD/trb/25D//7b//9v///+7G7IRAAAAoXRSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD//////////9XtYUAAAAAJcEhZcwAACxIAAAsSAdLdfvwAABwcSURBVHic7Z2JnyS3WYYjMmHNjQNjcwYSbnBmF7MwhrAc48UBGmLHS7BhNsQwiTmWgbETvFxDmmR3E0IaGhO6awbWO38qpTq6VFVS6Sgdn6Tv/W3vVHd/rZLqab0qqauk9xWoLPW+0BlAhRGCz1QIPlMh+EyF4DMVgs9UCD5TIfhMheAzFYLPVAg+UyH4TIXgMxWCz1QIPlMh+EyF4DMVgs9UCD5TIfhMheAzFYLP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" alt="plot of chunk unnamed-chunk-21"/> </p>

<pre><code>##      Model   Area   p.value binorm.area
## 1 Model  1 0.8416 1.417e-11          NA
## 2 Model  2 0.6956 6.942e-05          NA
</code></pre>

<p>Another library <a href="http://rocr.bioinf.mpi-sb.mpg.de/">ROCR</a> can also generate ROC curves for you.</p>

<pre><code class="r">install.packages(&quot;ROCR&quot;)
</code></pre>

<pre><code class="r">library(ROCR)
pred &lt;- prediction(prob.glm1.outsample, credit.test$Y)
perf &lt;- performance(pred, &quot;tpr&quot;, &quot;fpr&quot;)
plot(perf, colorize = TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-23"/> </p>

<pre><code class="r"># Get the AUC
unlist(slot(performance(pred, &quot;auc&quot;), &quot;y.values&quot;))
</code></pre>

<pre><code>## [1] 0.6956
</code></pre>

<h3>Cross validation and cost function</h3>

<p>Refer to lecture slides and Elements of Statistical Learning book (section 7.10) for more advice on cross validation.
You should read the cv.glm help to understand how it works.
First we define the cut-off probability and the define the cost function. <em>cost1</em> is a symmetric cost function, i.e. getting 1 wrong cost the same as getting 0 wrong. <em>cost2</em> is asymmetric cost function (we are double penalizing getting 1 wrong).</p>

<pre><code class="r">pcut = 0.2
# Symmetric cost
cost1 &lt;- function(r, pi) {
    mean(((r == 0) &amp; (pi &gt; pcut)) | ((r == 1) &amp; (pi &lt; pcut)))
}
# Asymmetric cost
cost2 &lt;- function(r, pi) {
    weight1 = 2
    weight0 = 1
    c1 = (r == 1) &amp; (pi &lt; pcut)  #logical vector - true if actual 1 but predict 0
    c0 = (r == 0) &amp; (pi &gt; pcut)  #logical vecotr - true if actual 0 but predict 1
    return(mean(weight1 * c1 + weight0 * c0))
}
</code></pre>

<p>10-fold cross validation, note we are using the <strong>full data</strong> to train and evaluate the model.</p>

<pre><code class="r">library(boot)
credit.glm3 &lt;- glm(Y ~ X3 + X8 + X11_2, family = binomial, credit.data)
cv.result = cv.glm(credit.data, credit.glm3, cost1, 10)
cv.result$delta
</code></pre>

<pre><code>## [1] 0.07660 0.07742
</code></pre>

<h2>Search for optimal cut-off probability</h2>

<p>The following code does a grid search from pcut = 0.01 to pcut = 0.99 with the objective of minimizing overall cost in the training set. I am using an asymmetric cost function by assuming that giving out a bad loan cost 10 time as much as rejecting application from someone who can pay.</p>

<pre><code class="r"># define the searc grid from 0.01 to 0.99
searchgrid = seq(0.01, 0.99, 0.01)
# result is a 99x2 matrix, the 1st col stores the cut-off p, the 2nd column
# stores the cost
result = cbind(searchgrid, NA)
# in the cost function, both r and pi are vectors, r=truth, pi=predicted
# probability
cost1 &lt;- function(r, pi) {
    weight1 = 10
    weight0 = 1
    c1 = (r == 1) &amp; (pi &lt; pcut)  #logical vector - true if actual 1 but predict 0
    c0 = (r == 0) &amp; (pi &gt; pcut)  #logical vecotr - true if actual 0 but predict 1
    return(mean(weight1 * c1 + weight0 * c0))
}
credit.glm1 &lt;- glm(Y ~ X3 + X8 + X11_2, family = binomial, credit.train)
for (i in 1:length(searchgrid)) {
    pcut &lt;- result[i, 1]
    # assign the cost to the 2nd col
    result[i, 2] &lt;- cost1(credit.train$Y, predict(credit.glm1, type = &quot;response&quot;))
}
plot(result, ylab = &quot;Cost in Training Set&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAhFBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOTllOY9lZgBltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC124+1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v23nRmsAAAALHRSTlP/////////////////////////////////////////////////////////AMfWCYwAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAutSURBVHic7d2LWttGAkDhKikLTVlIuruQvdRucYtt/P7vtxpfsF1EMvKMPCOf839JyYVODIfRSMKSf1gJ6YfSD0BlGB7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeKiV8o5oNGD7h/9XQDA9leCjDQxkeyvBQhocyPJThoQwPdbbw3z1JqLM6V/jm+/+WzsnwUIaHco2Hcq8eyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FDJ4Rc3zfWsaT4+9R1aRaWGf/k6Wc2u2/63zz2HVlGp4Zdfnlazu83bfkOrKGc8VI41/s41fnzcq4cyPFSu8Ac7d5EvTa+inPFQhofKsVcfuFc/MsnH8Y8P67fzK4/jRyXHmbvDt/FDqyhnPFTyGr+8d40fI/fqoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI81FnDew/7epwzfPP9f0/nYngow0O5xkO5Vw9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHigq/eanojheMThlaRUWE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" alt="plot of chunk unnamed-chunk-26"/> </p>

<pre><code class="r">result[which.min(result[, 2]), ]
</code></pre>

<pre><code>## searchgrid            
##     0.0900     0.4929
</code></pre>

<p>Alternatively, you can use the cross validation to choose the best cut-off probability.</p>

<pre><code class="r">searchgrid = seq(0.01, 0.6, 0.02)
result = cbind(searchgrid, NA)
cost1 &lt;- function(r, pi) {
    weight1 = 10
    weight0 = 1
    c1 = (r == 1) &amp; (pi &lt; pcut)  #logical vector - true if actual 1 but predict 0
    c0 = (r == 0) &amp; (pi &gt; pcut)  #logical vector - true if actual 0 but predict 1
    return(mean(weight1 * c1 + weight0 * c0))
}
credit.glm1 &lt;- glm(Y ~ X3 + X8 + X11_2, family = binomial, credit.train)
for (i in 1:length(searchgrid)) {
    pcut &lt;- result[i, 1]
    result[i, 2] &lt;- cv.glm(data = credit.train, glmfit = credit.glm1, cost = cost1, 
        K = 3)$delta[2]
}
plot(result, ylab = &quot;CV Cost&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"/> </p>

<pre><code class="r">result[which.min(result[, 2]), ]
</code></pre>

<pre><code>## searchgrid            
##     0.0900     0.4994
</code></pre>

<h2>Starter code for German credit scoring</h2>

<p>Refer to <a href="http://archive.ics.uci.edu/ml/datasets/Statlog+(German+Credit+Data)">http://archive.ics.uci.edu/ml/datasets/Statlog+(German+Credit+Data)</a> for variable description.
Notice that &ldquo;It is worse to class a customer as good when they are bad (5), than it is to class a customer as bad when they are good (1).&rdquo; Define your cost function accordingly!</p>

<pre><code class="r">german_credit = read.table(&quot;http://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/german.data&quot;)

colnames(german_credit) = c(&quot;chk_acct&quot;, &quot;duration&quot;, &quot;credit_his&quot;, &quot;purpose&quot;, 
    &quot;amount&quot;, &quot;saving_acct&quot;, &quot;present_emp&quot;, &quot;installment_rate&quot;, &quot;sex&quot;, &quot;other_debtor&quot;, 
    &quot;present_resid&quot;, &quot;property&quot;, &quot;age&quot;, &quot;other_install&quot;, &quot;housing&quot;, &quot;n_credits&quot;, 
    &quot;job&quot;, &quot;n_people&quot;, &quot;telephone&quot;, &quot;foreign&quot;, &quot;response&quot;)

# orginal response coding 1= good, 2 = bad we need 0 = good, 1 = bad
german_credit$response = german_credit$response - 1
</code></pre>

</body>

</html>

